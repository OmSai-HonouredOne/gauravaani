{% extends "admin/baseadmin.html" %}

{% block title %}Manage Lectures | Admin{% endblock %}

{% block content %}
<style>
/* OVERRIDE FLEX CENTERING FROM GLOBAL CSS */
body {
    display: block !important;
}
</style>

<div>
    <!-- BREADCRUMB -->
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb spiritual-breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('courses.index') }}">Home</a></li>
            <li class="breadcrumb-item"><a href="{{ url_for('admin.dashboard') }}">Admin</a></li>
            <li class="breadcrumb-item "><a href="{{ url_for('admin.manage_courses') }}">Manage Courses</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ course.course_title }}</li>
        </ol>
    </nav>
</div>

<div class="container my-5">

  <!-- COURSE INFO CARD -->
  <div class="admin-panel mb-4">
    <h2 class="text-center mb-3">Course Details</h2>

    <div class="row">
      <div class="col-md-8">
        <p><strong>Title :</strong> {{ course.course_title }}</p>
        <p><strong>Course ID :</strong> {{ course.course_id }}</p>
        <p><strong>Description :</strong></p>
        <p class="form-text summary-text">{{ course.course_description }}</p>
      </div>

      <div class="col-md-4 text-center">
        {% if course.course_image %}
          <img src="{{ course.course_image }}"
               class="img-fluid rounded shadow"
               style="max-height:200px;">
        {% else %}
          <p class="form-text">No Image</p>
        {% endif %}
      </div>
    </div>

    <div class="text-end mt-3">
      <a href="{{ url_for('admin.add_lecture', course_id=course.course_id) }}"
         class="btn btn-spiritual">
         + Add Lecture
      </a>
    </div>
</div>


  <!-- LECTURES TABLE -->
  <div class="admin-panel">
    <h3 class="text-center mb-4">Lectures List</h3>

    <div class="table-responsive">
      <table class="table table-dark table-hover align-middle text-center">
        <thead>
          <tr>
            <th>Course ID</th>
            <th>Chapter</th>
            <th>Lecture No</th>
            <th>Title</th>
            <!-- <th>Summary</th> -->
            <!-- <th>Lecture URL</th> -->
            <th>Notes URL</th>
            <th>Actions</th>
          </tr>
        </thead>

        <tbody>
        {% for lec in lectures %}
          <tr>
            <td>{{ course.course_id }}</td>
            <td>{{ lec.course_chapter }}</td>
            <td>{{ lec.lec_no }}</td>
            <td>{{ lec.lec_title }}</td>
            <!-- <td style="max-width:250px;" class="text-start">
              {{ lec.lec_summary[:20] }}....
            </td> -->

            <!-- <td>
              <a href="{{ lec.lec_url }}" target="_blank" class="btn btn-sm btn-outline-info">
                View
              </a>
            </td> -->

            <td>
              {% if lec.notes_url %}
                <a href="{{ lec.notes_url }}" target="_blank" class="btn btn-sm btn-outline-warning">
                  Notes
                </a>
              {% else %}
                <span class="">N/A</span>
              {% endif %}
            </td>

            <td>
              <a href="{{ url_for('admin.edit_lecture', course_id=course.course_id, ch=lec.course_chapter, lec_no=lec.lec_no) }}"
                 class="btn btn-sm btn-outline-success mb-1">
                Edit
              </a>

              <button class="btn btn-sm btn-outline-danger"
                      onclick="confirmDelete('/admin/{{ course.course_id }}/delete_lecture/{{ lec.lid }}')">
                Delete
              </button>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="8" class="text-muted">No lectures added yet.</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>


<script>
function confirmDelete(deleteUrl) {
    if (confirm("Are you sure you want to delete this lecture? This action cannot be undone.")) {
        window.location.href = deleteUrl;
    }
}
</script>

{% endblock %}
